<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2008-February/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20Mscan%3A%20BUG%21%20Tx%20Ring%20full%20when%20queue%20awake%21&In-Reply-To=%3CDD39B5C3F4963040ADC9768BE7E430CB02AF54C3%40is-hdq-exchange.marel.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000283.html">
   <LINK REL="Next"  HREF="000285.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!</H1>
    <B>Daniel Schnell</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20Mscan%3A%20BUG%21%20Tx%20Ring%20full%20when%20queue%20awake%21&In-Reply-To=%3CDD39B5C3F4963040ADC9768BE7E430CB02AF54C3%40is-hdq-exchange.marel.net%3E"
       TITLE="[Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!">daniel.schnell at marel.com
       </A><BR>
    <I>Mon Feb 11 15:02:33 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000283.html">[Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!
</A></li>
        <LI>Next message: <A HREF="000285.html">[Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#284">[ date ]</a>
              <a href="thread.html#284">[ thread ]</a>
              <a href="subject.html#284">[ subject ]</a>
              <a href="author.html#284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wolfgang Grandegger wrote:

&gt;<i> 
</I>&gt;<i> Interesting, some watchdog seems to restart the board. As the trace
</I>&gt;<i> is not complete, could you please replace tprint() in mscan.c showing
</I>&gt;<i> the trace from bottom to top with the code below:  
</I>&gt;<i> 
</I>&gt;<i> -------------------
</I>&gt;<i> static void tprint(struct mscan_priv *priv) {
</I>&gt;<i>         int i, j, d;
</I>&gt;<i> 
</I>&gt;<i>         printk(&quot;tprint: head at %d\n&quot;, priv-&gt;tcount);
</I>&gt;<i>         for (i = priv-&gt;tcount; i &gt; (priv-&gt;tcount - TSIZE); i--) {
</I>&gt;<i>                 j = i &gt;= 0 ? i : i + TSIZE;
</I>&gt;<i>                 d = priv-&gt;tdata[j];
</I>&gt;<i>                 printk(&quot;%04d: %02x %02x %02x %02x\n&quot;, j,
</I>&gt;<i>                        (d &gt;&gt; 24) &amp; 0xff, (d &gt;&gt; 16) &amp; 0xff,
</I>&gt;<i>                        (d &gt;&gt; 8)  &amp; 0xff, d &amp; 0xff);
</I>&gt;<i>         }
</I>&gt;<i> }
</I>&gt;<i> -------------------
</I>&gt;<i> 
</I>&gt;<i> Hopefully the last try.
</I>&gt;<i> 
</I>
[   66.149326] mpc52xx-mscan mpc52xx-mscan.0: BUG! Tx Ring full when
queue awake!
[   66.156736] can0: TX on=1 pend=3
[   66.160036] tprint: head at 713
[   66.163263] 0713: 05 00 ea 02
[   66.166298] 0712: 00 01 07 07
[   66.169336] 0711: 06 01 07 07
[   66.172367] 0710: 05 00 7b 02
[   66.175401] 0709: 03 00 07 07
[   66.178441] 0708: 02 00 00 07
[   66.181481] 0707: 01 00 7b 02
[   66.184528] 0706: 00 01 05 05
[   66.187569] 0705: 06 01 07 05
[   66.190617] 0704: 05 00 7a 02
[   66.193658] 0703: 04 00 02 05
[   66.196709] 0702: 03 02 07 07
[   66.199749] 0701: 02 00 00 07
[   66.202782] 0700: 01 00 7a 02
[   66.205821] 0699: 00 01 06 06
[   66.208859] 0698: 06 01 07 06
[   66.211907] 0697: 05 00 79 02
[   66.214940] 0696: 04 00 01 06
[   66.217976] 0695: 03 01 07 07
[   66.221014] 0694: 02 00 00 07
[   66.224048] 0693: 01 00 79 02
[   66.227086] 0692: 00 01 03 03
[   66.230125] 0691: 06 01 07 03
[   66.233174] 0690: 05 00 78 02
[   66.236204] 0689: 04 00 04 03
[   66.239238] 0688: 03 04 07 07
[   66.242281] 0687: 02 00 00 07
[   66.245314] 0686: 01 00 78 02
[   66.248353] 0685: 00 01 05 05
[   66.251393] 0684: 06 01 07 05
[   66.254442] 0683: 05 00 77 02
[   66.257480] 0682: 04 00 02 05
[   66.260532] 0681: 03 02 07 07
[   66.263569] 0680: 02 00 00 07
[   66.266621] 0679: 01 00 77 02
[   66.269657] 0678: 00 01 06 06
[   66.272709] 0677: 06 01 07 06
[   66.275748] 0676: 05 00 76 02
[   66.278779] 0675: 04 00 01 06
[   66.281822] 0674: 03 01 07 07
[   66.284861] 0673: 02 00 00 07
[   66.287910] 0672: 01 00 76 02
[   66.290950] 0671: 00 01 03 03
[   66.293998] 0670: 06 01 07 03
[   66.297038] 0669: 05 00 75 02
[   66.300087] 0668: 04 00 04 03
[   66.303127] 0667: 03 04 07 07
[   66.306175] 0666: 02 00 00 07
[   66.309215] 0665: 01 00 75 02
[   66.312263] 0664: 00 01 05 05
[   66.315293] 0663: 06 01 07 05
[   66.318331] 0662: 05 00 74 02
[   66.321370] 0661: 04 00 02 05
[   66.324403] 0660: 03 02 07 07
[   66.327440] 0659: 02 00 00 07
[   66.330481] 0658: 01 00 74 02
[   66.333530] 0657: 00 01 06 06
[   66.336569] 0656: 06 01 07 06
[   66.339619] 0655: 05 00 73 02
[   66.342659] 0654: 04 00 01 06
[   66.345709] 0653: 03 01 07 07
[   66.348748] 0652: 02 00 00 07
[   66.351784] 0651: 01 00 73 02
[   66.354819] 0650: 00 01 03 03
[   66.357859] 0649: 06 01 07 03
[   66.360908] 0648: 05 00 72 02
[   66.363948] 0647: 04 00 04 03
[   66.366997] 0646: 03 04 07 07
[   66.370037] 0645: 02 00 00 07
[   66.373086] 0644: 01 00 72 02
[   66.376127] 0643: 00 01 05 05
[   66.379176] 0642: 06 01 07 05
[   66.382216] 0641: 05 00 71 02
[   66.385263] 0640: 04 00 02 05
[   66.388305] 0639: 03 02 07 07
[   66.391353] 0638: 02 00 00 07
[   66.394393] 0637: 01 00 71 02
[   66.397439] 0636: 00 01 06 06
[   66.400479] 0635: 06 01 07 06
[   66.403528] 0634: 05 00 70 02
[   66.406569] 0633: 04 00 01 06
[   66.409617] 0632: 03 01 07 07
[   66.412657] 0631: 02 00 00 07
[   66.415707] 0630: 01 00 70 02
[   66.418749] 0629: 00 01 03 03
[   66.421781] 0628: 06 01 07 03
[   66.424820] 0627: 05 00 6f 02
[   66.427859] 0626: 04 00 04 03
[   66.430912] 0625: 03 04 07 07
[   66.433947] 0624: 02 00 00 07
[   66.436996] 0623: 01 00 6f 02
[   66.440036] 0622: 00 01 05 05
[   66.443085] 0621: 06 01 07 05
[   66.446116] 0620: 05 00 6e 02
[   66.449150] 0619: 04 00 02 05
[   66.452183] 0618: 03 02 07 07
[   66.455219] 0617: 02 00 00 07
[   66.458265] 0616: 01 00 6e 02
[   66.461304] 0615: 00 01 06 06
[   66.464353] 0614: 06 01 07 06
[   66.467392] 0613: 05 00 6d 02
[   66.470441] 0612: 04 00 01 06
[   66.473480] 0611: 03 01 07 07
[   66.476532] 0610: 02 00 00 07
[   66.479568] 0609: 01 00 6d 02
[   66.482621] 0608: 00 01 03 03
[   66.485658] 0607: 06 01 07 03
[   66.488711] 0606: 05 00 6c 02
[   66.491750] 0605: 04 00 04 03
[   66.494786] 0604: 03 04 07 07
[   66.497822] 0603: 02 00 00 07
[   66.500861] 0602: 01 00 6c 02
[   66.503910] 0601: 00 01 05 05
[   66.506949] 0600: 06 01 07 05
[   66.509999] 0599: 05 00 6b 02
[   66.513038] 0598: 04 00 02 05
[   66.516087] 0597: 03 02 07 07
[   66.519126] 0596: 02 00 00 07
[   66.522175] 0595: 01 00 6b 02
[   66.525214] 0594: 00 01 06 06
[   66.528265] 0593: 06 01 07 06
[   66.531303] 0592: 05 00 6a 02
[   66.534354] 0591: 04 00 01 06
[   66.537391] 0590: 03 01 07 07
[   66.540440] 0589: 02 00 00 07
[   66.543480] 0588: 01 00 6a 02
[   66.546529] 0587: 00 01 03 03
[   66.549569] 0586: 06 01 07 03
[   66.552619] 0585: 05 00 69 02
[   66.555659] 0584: 04 00 04 03
[   66.558710] 0583: 03 04 07 07
[   66.561746] 0582: 02 00 00 07
[   66.564778] 0581: 01 00 69 02
[   66.567819] 0580: 00 01 05 05
[   66.570859] 0579: 06 01 07 05
[   66.573907] 0578: 05 00 68 02
[   66.576948] 0577: 04 00 02 05
[   66.579997] 0576: 03 02 07 07
[   66.583037] 0575: 02 00 00 07
[   66.586086] 0574: 01 00 68 02
[   66.589127] 0573: 00 01 06 06
[   66.592174] 0572: 06 01 07 06
[   66.595216] 0571: 05 00 67 02
[   66.598265] 0570: 04 00 01 06
[   66.601305] 0569: 03 01 07 07
[   66.604351] 0568: 02 00 00 07
[   66.607393] 0567: 01 00 67 02
[   66.610443] 0566: 00 01 03 03
[   66.613479] 0565: 06 01 07 03
[   66.616528] 0564: 05 00 66 02
[   66.619568] 0563: 04 00 04 03
[   66.622618] 0562: 03 04 07 07
[   66.625658] 0561: 02 00 00 07
[   66.628709] 0560: 01 00 66 02
[   66.631749] 0559: 00 01 05 05
[   66.634784] 0558: 06 01 07 05
[   66.637822] 0557: 05 00 65 02
[   66.640859] 0556: 04 00 02 05
[   66.643911] 0555: 03 02 07 07
[   66.646947] 0554: 02 00 00 07
[   66.650001] 0553: 01 00 65 02
[   66.653036] 0552: 00 01 06 06
[   66.656089] 0551: 06 01 07 06
[   66.659125] 0550: 05 00 64 02
[   66.662174] 0549: 04 00 01 06
[   66.665205] 0548: 03 01 07 07
[   66.668238] 0547: 02 00 00 07
[   66.671271] 0546: 01 00 64 02
[   66.674308] 0545: 00 01 03 03
[   66.677353] 0544: 06 01 07 03
[   66.680393] 0543: 05 00 63 02
[   66.683440] 0542: 04 00 04 03
[   66.686473] 0541: 03 04 07 07
[   66.689504] 0540: 02 00 00 07
[   66.692539] 0539: 01 00 63 02
[   66.695573] 0538: 00 01 05 05
[   66.698621] 0537: 06 01 07 05
[   66.701657] 0536: 05 00 62 02
[   66.704707] 0535: 04 00 02 05
[   66.707748] 0534: 03 02 07 07
[   66.710785] 0533: 02 00 00 07
[   66.713822] 0532: 01 00 62 02
[   66.716861] 0531: 00 01 06 06
[   66.719910] 0530: 06 01 07 06
[   66.722949] 0529: 05 00 61 02
[   66.725998] 0528: 04 00 01 06
[   66.729038] 0527: 03 01 07 07
[   66.732087] 0526: 02 00 00 07
[   66.735126] 0525: 01 00 61 02
[   66.738176] 0524: 00 01 03 03
[   66.741216] 0523: 06 01 07 03
[   66.744266] 0522: 05 00 60 02
[   66.747302] 0521: 04 00 04 03
[   66.750352] 0520: 03 04 07 07
[   66.753391] 0519: 02 00 00 07
[   66.756442] 0518: 01 00 60 02
[   66.759480] 0517: 00 01 05 05
[   66.762529] 0516: 06 01 07 05
[   66.765570] 0515: 05 00 5f 02
[   66.768619] 0514: 04 00 02 05
[   66.771659] 0513: 03 02 07 07
[   66.774709] 0512: 02 00 00 07
[   66.777747] 0511: 01 00 5f 02
[   66.780784] 0510: 00 01 06 06
[   66.783821] 0509: 06 01 07 06
[   66.786859] 0508: 05 00 5e 02
[   66.789908] 0507: 04 00 01 06
[   66.792948] 0506: 03 01 07 07
[   66.795996] 0505: 02 00 00 07
[   66.799037] 0504: 01 00 5e 02
[   66.802086] 0503: 00 01 03 03
[   66.805126] 0502: 06 01 07 03
[   66.808175] 0501: 05 00 5d 02
[   66.811216] 0500: 04 00 04 03
[   66.814263] 0499: 03 04 07 07
[   66.817305] 0498: 02 00 00 07
[   66.820354] 0497: 01 00 5d 02
[   66.823392] 0496: 00 01 05 05
[   66.826439] 0495: 06 01 07 05
[   66.829480] 0494: 05 00 5c 02
[   66.832529] 0493: 04 00 02 05
[   66.835569] 0492: 03 02 07 07
[   66.838618] 0491: 02 00 00 07
[   66.841658] 0490: 01 00 5c 02
[   66.844709] 0489: 00 01 06 06
[   66.847749] 0488: 06 01 07 06
[   66.850783] 0487: 05 00 5b 02
[   66.853821] 0486: 04 00 01 06
[   66.856859] 0485: 03 01 07 07
[   66.859911] 0484: 02 00 00 07
[   66.862947] 0483: 01 00 5b 02
[   66.866000] 0482: 00 01 03 03
[   66.869037] 0481: 06 01 07 03
[   66.872084] 0480: 05 00 5a 02
[   66.875117] 0479: 04 00 04 03
[   66.878155] 0478: 03 04 07 07
[   66.881192] 0477: 02 00 00 07
[   66.884227] 0476: 01 00 5a 02
[   66.887264] 0475: 00 01 05 05
[   66.890304] 0474: 06 01 07 05
[   66.893354] 0473: 05 00 59 02
[   66.896392] 0472: 04 00 02 05
[   66.899443] 0471: 03 02 07 07
[   66.902480] 0470: 02 00 00 07
[   66.905527] 0469: 01 00 59 02
[   66.908569] 0468: 00 01 06 06
[   66.911622] 0467: 06 01 07 06
[   66.914657] 0466: 05 00 58 02
[   66.917710] 0465: 04 00 01 06
[   66.920748] 0464: 03 01 07 07
[   66.923784] 0463: 02 00 00 07
[   66.926821] 0462: 01 00 58 02
[   66.929859] 0461: 00 01 03 03
[   66.932909] 0460: 06 01 07 03
[   66.935949] 0459: 05 00 57 02
[   66.938999] 0458: 04 00 04 03
[   66.942038] 0457: 03 04 07 07
[   66.945087] 0456: 02 00 00 07
[   66.948126] 0455: 01 00 57 02
[   66.951175] 0454: 00 01 05 05
[   66.954215] 0453: 06 01 07 05
[   66.957266] 0452: 05 00 56 02
[   66.960302] 0451: 04 00 02 05
[   66.963352] 0450: 03 02 07 07
[   66.966391] 0449: 02 00 00 07
[   66.969444] 0448: 01 00 56 02
[   66.972480] 0447: 00 01 06 06
[   66.975529] 0446: 06 01 07 06
[   66.978570] 0445: 05 00 55 02
[   66.981619] 0444: 04 00 01 06
[   66.984659] 0443: 03 01 07 07
[   66.987710] 0442: 02 00 00 07
[   66.990748] 0441: 01 00 55 02
[   66.993784] 0440: 00 01 03 03
[   66.996821] 0439: 06 01 07 03
[   66.999859] 0438: 05 00 54 02
[   67.002909] 0437: 04 00 04 03
[   67.005939] 0436: 03 04 07 07
[   67.008972] 0435: 02 00 00 07
[   67.012008] 0434: 01 00 54 02
[   67.015043] 0433: 00 01 05 05
[   67.018085] 0432: 06 01 07 05
[   67.021125] 0431: 05 00 53 02
[   67.024157] 0430: 04 00 02 05
[   67.027189] 0429: 03 02 07 07
[   67.030222] 0428: 02 00 00 07
[   67.033263] 0427: 01 00 53 02
[   67.036296] 0426: 00 01 06 06
[   67.039329] 0425: 06 01 07 06
[   67.042367] 0424: 05 00 52 02
[   67.045397] 0423: 04 00 01 06
[   67.048439] 0422: 03 01 07 07
[   67.051481] 0421: 02 00 00 07
[   67.054528] 0420: 01 00 52 02
[   67.057559] 0419: 00 01 03 03
[   67.060593] 0418: 06 01 07 03
[   67.063629] 0417: 05 00 51 02
[   67.066663] 0416: 04 00 04 03
[   67.069713] 0415: 03 04 07 07
[   67.072749] 0414: 02 00 00 07
[   67.075779] 0413: 01 00 51 02
[   67.078818] 0412: 00 01 05 05
[   67.081852] 0411: 06 01 07 05
[   67.084881] 0410: 05 00 50 02
[   67.087912] 0409: 04 00 02 05
[   67.090948] 0408: 03 02 07 07
[   67.093995] 0407: 02 00 00 07
[   67.097026] 0406: 01 00 50 02
[   67.100056] 0405: 00 01 06 06
[   67.103090] 0404: 06 01 07 06
[   67.106125] 0403: 05 00 4f 02
[   67.109176] 0402: 04 00 01 06
[   67.112214] 0401: 03 01 07 07
[   67.115264] 0400: 02 00 00 07
[   67.118303] 0399: 01 00 4f 02
[   67.121353] 0398: 00 01 03 03
[   67.124393] 0397: 06 01 07 03
[   67.127442] 0396: 05 00 4e 02
[   67.130481] 0395: 04 00 04 03
[   67.133531] 0394: 03 04 07 07
[   67.136570] 0393: 02 00 00 07
[   67.139621] 0392: 01 00 4e 02
[   67.142658] 0391: 00 01 05 05
[   67.145709] 0390: 06 01 07 05
[   67.148748] 0389: 05 00 4d 02
[   67.151780] 0388: 04 00 02 05
[   67.154822] 0387: 03 02 07 07
[   67.157859] 0386: 02 00 00 07
[   67.160910] 0385: 01 00 4d 02
[   67.163950] 0384: 00 01 06 06
[   67.166999] 0383: 06 01 07 06
[   67.170038] 0382: 05 00 4c 02
[   67.173087] 0381: 04 00 01 06
[   67.176127] 0380: 03 01 07 07
[   67.179175] 0379: 02 00 00 07
[   67.182215] 0378: 01 00 4c 02
[   67.185264] 0377: 00 01 03 03
[   67.188303] 0376: 06 01 07 03
[   67.191352] 0375: 05 00 4b 02
[   67.194391] 0374: 04 00 04 03
[   67.197440] 0373: 03 04 07 07
[   67.200480] 0372: 02 00 00 07
[   67.203529] 0371: 01 00 4b 02
[   67.206570] 0370: 00 01 05 05
[   67.209619] 0369: 06 01 07 05
[   67.212658] 0368: 05 00 4a 02
[   67.215710] 0367: 04 00 02 05



Yes our watchdog is biting here, but I can turn it off if you like :)

Find above the output according to your new tprint() function.



Best regards,

Daniel.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000283.html">[Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!
</A></li>
	<LI>Next message: <A HREF="000285.html">[Socketcan-users] Mscan: BUG! Tx Ring full when queue awake!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#284">[ date ]</a>
              <a href="thread.html#284">[ thread ]</a>
              <a href="subject.html#284">[ subject ]</a>
              <a href="author.html#284">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
