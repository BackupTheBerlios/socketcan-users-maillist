<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] mscan: RXACT never got cleared
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20mscan%3A%20RXACT%20never%20got%20cleared&In-Reply-To=%3C20091104085743.GB4513%40pengutronix.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001122.html">
   <LINK REL="Next"  HREF="001124.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] mscan: RXACT never got cleared</H1>
    <B>Luotao Fu</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20mscan%3A%20RXACT%20never%20got%20cleared&In-Reply-To=%3C20091104085743.GB4513%40pengutronix.de%3E"
       TITLE="[Socketcan-users] mscan: RXACT never got cleared">l.fu at pengutronix.de
       </A><BR>
    <I>Wed Nov  4 09:57:43 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001122.html">[Socketcan-users] mscan: RXACT never got cleared
</A></li>
        <LI>Next message: <A HREF="001124.html">[Socketcan-users] mscan: RXACT never got cleared
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1123">[ date ]</a>
              <a href="thread.html#1123">[ thread ]</a>
              <a href="subject.html#1123">[ subject ]</a>
              <a href="author.html#1123">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Wolfgang,

On Wed, Nov 04, 2009 at 09:30:18AM +0100, Wolfgang Grandegger wrote:
&gt;<i> Luotao Fu wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On Wed, Nov 04, 2009 at 09:13:03AM +0100, Wolfgang Grandegger wrote:
</I>&gt;<i> &gt;&gt; Luotao Fu wrote:
</I>&gt;<i> &gt;&gt;&gt; Hi Wolfgang,
</I>&gt;<i> &gt;&gt;&gt;
</I>....
&gt;<i> &gt;&gt;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; ? I'm a little confused, just for the record: You called
</I>&gt;<i> &gt; ifconfig can2 down
</I>&gt;<i> &gt; before you brought up the interface?
</I>&gt;<i> 
</I>&gt;<i> No, because the module was just loaded. But even if I do a &quot;ifconfig
</I>&gt;<i> can2 down&quot;, it will fail.
</I>&gt;<i> 
</I>
init_mode (slprq | initrq) is set while the interface is shut down. This
is the place where the warning comes from.

&gt;<i> &gt;&gt;
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; No. The slprq will eventually fail if there're irregular activities on
</I>&gt;<i> &gt; the bus, like a opposite with wrong baudrate keep resending its stuffs.
</I>&gt;<i> 
</I>&gt;<i> On my board, it always fails! Even without any traffic on the bus.
</I>
This is really strange, I can't reproduce this on my board here.

# /sbin/ip link set can1 type can bitrate 125000
[  215.118944] mpc52xx_can f0000980.can: setting BTR0=0x15 BTR1=0x18
# ifconfig can1 down
# ifconfig can1 up
#

Btw. the platform I'm working on is a 1.4
# cat /proc/cpuinfo | grep revision
revision        : 1.4 (pvr 8082 2014)
I will try to do some tests on another mpc5200b hardware here also later
today.

Stupid question: does your board work normally without the patch? The
warning indicates that the slprq didn't get through and slprq bit should
be set then and the controller should be broken as long as itself or the
bus is not restarted.

cheers
Luotao Fu
-- 
Pengutronix e.K.                           | Dipl.-Ing. Luotao Fu        |
Industrial Linux Solutions                 | <A HREF="http://www.pengutronix.de/">http://www.pengutronix.de/</A>  |
Peiner Str. 6-8, 31137 Hildesheim, Germany | Phone: +49-5121-206917-0    |
Amtsgericht Hildesheim, HRA 2686           | Fax:   +49-5121-206917-5555 |
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/socketcan-users/attachments/20091104/660a2de1/attachment.pgp">https://lists.berlios.de/pipermail/socketcan-users/attachments/20091104/660a2de1/attachment.pgp</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001122.html">[Socketcan-users] mscan: RXACT never got cleared
</A></li>
	<LI>Next message: <A HREF="001124.html">[Socketcan-users] mscan: RXACT never got cleared
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1123">[ date ]</a>
              <a href="thread.html#1123">[ thread ]</a>
              <a href="subject.html#1123">[ subject ]</a>
              <a href="author.html#1123">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
