<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] IOCTL SocketCan Rev. 399 and sja1000-iomem
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20IOCTL%20SocketCan%20Rev.%20399%20and%20sja1000-iomem&In-Reply-To=%3C474F35C3.6090009%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000206.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] IOCTL SocketCan Rev. 399 and sja1000-iomem</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20IOCTL%20SocketCan%20Rev.%20399%20and%20sja1000-iomem&In-Reply-To=%3C474F35C3.6090009%40grandegger.com%3E"
       TITLE="[Socketcan-users] IOCTL SocketCan Rev. 399 and sja1000-iomem">wg at grandegger.com
       </A><BR>
    <I>Thu Nov 29 22:57:23 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000206.html">[Socketcan-users] IOCTL SocketCan Rev. 399 and sja1000-iomem
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#207">[ date ]</a>
              <a href="thread.html#207">[ thread ]</a>
              <a href="subject.html#207">[ subject ]</a>
              <a href="author.html#207">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Oliver,

Oliver Hartkopp wrote:
&gt;<i> Kai Riedmann wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> at the moment I'm trying to write a software for switching baud rates
</I>&gt;&gt;<i> when socketcan already has started working. When executing this code:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> struct ifreq ifrSet;
</I>&gt;&gt;<i> unsigned long* br = (unsigned long*) &amp;ifrSet.ifr_ifru;
</I>&gt;&gt;<i> *br = 0x04;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> strcpy( ifrSet.ifr_name, &quot;can0&quot; );
</I>&gt;&gt;<i> if(ioctl( can_socket, SIOCSCANBAUDRATE, &amp;ifrSet ) &lt; 0)
</I>&gt;&gt;<i>         perror( &quot;SIOCSCANBAUDRATE&quot; );
</I>&gt;&gt;<i>         
</I>&gt;&gt;<i> the baudrate should be changed of the sja1000-Chip but it doesn't work,
</I>&gt;&gt;<i> the bit rate still stays at 500 kBit/s. Is there something done wrong on
</I>&gt;&gt;<i> my side or is this ioctl not implemented yet because I didn't find any
</I>&gt;&gt;<i> parts for SIOCSCANBAUDRATE at sja1000.c file at function can_ioctl.
</I>&gt;<i> 
</I>&gt;<i> Hello Kai,
</I>&gt;<i> 
</I>&gt;<i> the 'old' style sja1000 driver does not support ioctl(). So you looked
</I>&gt;<i> at the right source not finding any parts for SIOCSCANBAUDRATE :-/
</I>&gt;<i> 
</I>&gt;<i> AFAIK only the mscan driver supports ioctl() or at least parts of them.
</I>
The MSCAN driver does not support ioctls directly. This is done through
access functions in the CAN device structure and also the CCAN driver
have them. It is rather easy to map ioctls requests to sysfs files and I
already have a preliminary solution. I hope to have the RFC patches
ready tomorrow.

Wolfgang.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000206.html">[Socketcan-users] IOCTL SocketCan Rev. 399 and sja1000-iomem
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#207">[ date ]</a>
              <a href="thread.html#207">[ thread ]</a>
              <a href="subject.html#207">[ subject ]</a>
              <a href="author.html#207">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
