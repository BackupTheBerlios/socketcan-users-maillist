<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] [PATCH] Add BCM intro and structure
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2010-October/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20%5BPATCH%5D%20Add%20BCM%20intro%20and%20structure&In-Reply-To=%3C20101003165731.GA910%40milesteg.arr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001528.html">
   <LINK REL="Next"  HREF="001529.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] [PATCH] Add BCM intro and structure</H1>
    <B>Daniele Venzano</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20%5BPATCH%5D%20Add%20BCM%20intro%20and%20structure&In-Reply-To=%3C20101003165731.GA910%40milesteg.arr%3E"
       TITLE="[Socketcan-users] [PATCH] Add BCM intro and structure">linux at brownhat.org
       </A><BR>
    <I>Sun Oct  3 18:57:31 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001528.html">[Socketcan-users] Driver for the Peak-USB-CAN-Card
</A></li>
        <LI>Next message: <A HREF="001529.html">[Socketcan-users] Interface options in modprobe.d
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1527">[ date ]</a>
              <a href="thread.html#1527">[ thread ]</a>
              <a href="subject.html#1527">[ subject ]</a>
              <a href="author.html#1527">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

here is another patch, it adds the BCM introduction and a tentative
subdivision in sections for everything else. I hope editing it with vim
is the same :-)

For now I decided to keep everything in a single file.

Thsnk, bye


Index: kernel/2.6/Documentation/networking/can.txt
===================================================================
--- kernel/2.6/Documentation/networking/can.txt	(revision 1198)
+++ kernel/2.6/Documentation/networking/can.txt	(working copy)
@@ -23,6 +23,15 @@
       4.1.3 RAW socket option CAN_RAW_LOOPBACK
       4.1.4 RAW socket option CAN_RAW_RECV_OWN_MSGS
     4.2 Broadcast Manager protocol sockets (SOCK_DGRAM)
+      4.2.1 Opening BCM sockets
+      4.2.2 BCM messages (struct bcm_msg_head)
+      4.2.3 TX_SETUP opcode
+      4.2.4 TX_DELETE opcode
+      4.2.5 TX_READ opcode
+      4.2.6 TX_SEND opcode
+      4.2.7 RX_SETUP opcode
+      4.2.8 RX_DELETE opcode
+      4.2.9 RX_READ opcode      
     4.3 connected transport protocols (SOCK_SEQPACKET)
     4.4 unconnected transport protocols (SOCK_DGRAM)
     4.5 Timestamps
@@ -473,6 +482,41 @@
                &amp;recv_own_msgs, sizeof(recv_own_msgs));
 
   4.2 Broadcast Manager protocol sockets (SOCK_DGRAM)
+  
+  The Broadcast Manager (BCM) provides functions to send CAN frames
+  once or periodically, as well as notify applications of changes in
+  received CAN frames, recognizing specific CAN IDs.
+
+  Capabilities on the trasmission side:
+  - Cyclic transmission of a CAN frame with a given interval
+  - Modification of message content and intervals at runtime (e.g.
+    switching to a new interval with or without immediate restart of
+    the timer)
+  - Automatically switching to a second interval after a certain number
+    of frames has been sent
+  - Instant transmission of changed frames, without influencing the
+    interval cycle
+  - One-time transmission of CAN messages
+
+  Capabilities on the receiving side:
+  - Receive filter to detect changes in frame ID, data or length (DLC)
+  - Receive filter for multiplex frames (e.g. with packet counters in
+    the data field)
+  - RTR replies to messages
+  - Time-out monitoring of frames
+  - Frequency reduction of messages (throttle function) to the user
+    application
+
+    4.2.1 Opening BCM sockets
+    4.2.2 BCM messages (struct bcm_msg_head)
+    4.2.3 TX_SETUP opcode
+    4.2.4 TX_DELETE opcode
+    4.2.5 TX_READ opcode
+    4.2.6 TX_SEND opcode
+    4.2.7 RX_SETUP opcode
+    4.2.8 RX_DELETE opcode
+    4.2.9 RX_READ opcode      
+
   4.3 connected transport protocols (SOCK_SEQPACKET)
   4.4 unconnected transport protocols (SOCK_DGRAM)
 

-- 
Daniele Venzano
<A HREF="http://www.brownhat.org">http://www.brownhat.org</A>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001528.html">[Socketcan-users] Driver for the Peak-USB-CAN-Card
</A></li>
	<LI>Next message: <A HREF="001529.html">[Socketcan-users] Interface options in modprobe.d
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1527">[ date ]</a>
              <a href="thread.html#1527">[ thread ]</a>
              <a href="subject.html#1527">[ subject ]</a>
              <a href="author.html#1527">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
