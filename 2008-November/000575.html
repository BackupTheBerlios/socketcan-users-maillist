<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] Can't get SocketCan to work on a MPC5200b	board
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20Can%27t%20get%20SocketCan%20to%20work%20on%20a%20MPC5200b%0A%09board&In-Reply-To=%3C491B4EC9.4040303%40hartkopp.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000573.html">
   <LINK REL="Next"  HREF="000588.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] Can't get SocketCan to work on a MPC5200b	board</H1>
    <B>Oliver Hartkopp</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20Can%27t%20get%20SocketCan%20to%20work%20on%20a%20MPC5200b%0A%09board&In-Reply-To=%3C491B4EC9.4040303%40hartkopp.net%3E"
       TITLE="[Socketcan-users] Can't get SocketCan to work on a MPC5200b	board">socketcan at hartkopp.net
       </A><BR>
    <I>Wed Nov 12 22:46:49 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000573.html">[Socketcan-users] Can't get SocketCan to work on a MPC5200b	board
</A></li>
        <LI>Next message: <A HREF="000588.html">[Socketcan-users] Still newbie: Can't wait for TX buffers available to avoid overrun
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#575">[ date ]</a>
              <a href="thread.html#575">[ thread ]</a>
              <a href="subject.html#575">[ subject ]</a>
              <a href="author.html#575">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nick wrote:
&gt;<i> Oliver Hartkopp wrote:
</I>
&gt;&gt;<i> Did you use the latest SocketCAN SVN to build your mscan driver, or 
</I>&gt;&gt;<i> how did you get the mscan driver into your 2.6.27-rc6?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I used the lastest SocketCAN svn, and patched my kernel
</I>&gt;<i> Here is the output from dmesg:
</I>&gt;<i>
</I>&gt;<i> [ 0.000000] Using motion5200b machine description
</I>&gt;<i> [ 0.000000] Linux version 2.6.27-rc6 (<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-users">ndroogh at localhost.localdomain</A>) 
</I>&gt;<i> (gcc version 4.2.2) #82 PREEMPT Wed Nov 12 15:04:49 EST 2008
</I>&gt;<i> (..)
</I>&gt;<i> [ 3.808573] brd: module loaded
</I>&gt;<i> [ 3.824166] loop: module loaded
</I>&gt;<i> [ 3.830493] mpc52xx-mscan mpc52xx-mscan.0: probe for port 0xC901C900 
</I>&gt;<i> done (irq=151)
</I>&gt;<i> [ 3.839695] mpc52xx-mscan mpc52xx-mscan.1: probe for port 0xC901E980 
</I>&gt;<i> done (irq=152)
</I>&gt;<i> [ 3.872388] mpc52xx MII bus: probed
</I>
Hm - i'm missing the startup message from the &quot;CAN netdevice library&quot; 
with the sysfs support here, which the latest mscan is using.

Did you need to set the bitrate via sysfs before you had been able to 
set ifconfig can0 up?

e.g. like this:

# echo 125000 &gt;/sys/class/net/can0/can_bittiming/bitrate
# ifconfig can0 up

The new driver has no default bitrate anymore - so setting this is mandatory now.


I would suggest to patch your vanilla 2.6.27-rcX Kernel as described here:
<A HREF="https://lists.berlios.de/pipermail/socketcan-users/2008-October/000535.html">https://lists.berlios.de/pipermail/socketcan-users/2008-October/000535.html</A>

And also use this patch from Wolfgang from a separate thread:
<A HREF="https://lists.berlios.de/pipermail/socketcan-users/2008-November/000574.html">https://lists.berlios.de/pipermail/socketcan-users/2008-November/000574.html</A>

Regards,
Oliver


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000573.html">[Socketcan-users] Can't get SocketCan to work on a MPC5200b	board
</A></li>
	<LI>Next message: <A HREF="000588.html">[Socketcan-users] Still newbie: Can't wait for TX buffers available to avoid overrun
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#575">[ date ]</a>
              <a href="thread.html#575">[ thread ]</a>
              <a href="subject.html#575">[ subject ]</a>
              <a href="author.html#575">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
