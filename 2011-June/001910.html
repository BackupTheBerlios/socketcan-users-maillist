<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] SPEAR320 SOC TX problem
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2011-June/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20SPEAR320%20SOC%20TX%20problem&In-Reply-To=%3C869AED1C-C4FC-475D-8BD8-F7F089790266%40mimectl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001909.html">
   <LINK REL="Next"  HREF="001911.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] SPEAR320 SOC TX problem</H1>
    <B>Hermann, Charles J CIV NSWCCD Philadelphia, 9660</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20SPEAR320%20SOC%20TX%20problem&In-Reply-To=%3C869AED1C-C4FC-475D-8BD8-F7F089790266%40mimectl%3E"
       TITLE="[Socketcan-users] SPEAR320 SOC TX problem">charles.j.hermann at navy.mil
       </A><BR>
    <I>Wed Jun  1 15:35:54 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001909.html">[Socketcan-users] SPEAR320 SOC TX problem
</A></li>
        <LI>Next message: <A HREF="001911.html">[Socketcan-users] Advantech PCI-1680U card
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1910">[ date ]</a>
              <a href="thread.html#1910">[ thread ]</a>
              <a href="subject.html#1910">[ subject ]</a>
              <a href="author.html#1910">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>yes the application handles  ENOBUFS using sched_yield(). It seems more likely to be a driver issue,as tx quits completely but the bus is up and running. STlinux 2.4 is based on kernel 2.6.32. I might be able to get that working but I dont know if it will help. I will try to engage help from ST also.

Thanks,

Charles J. Hermann
Lead Hardware Designer
NSWCCD-SSES Code 967
<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-users">charles.j.hermann at navy.mil</A>
215 897-8548



From: Wolfgang Grandegger
Sent: Wed 6/1/2011 9:13 AM
To: Charles H
Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-users">socketcan-users at lists.berlios.de</A>
Subject: Re: [Socketcan-users]  SPEAR320 SOC TX problem


On 06/01/2011 02:57 PM, Charles H wrote:
&gt;<i> 
</I>&gt;<i> Hello:
</I>&gt;<i> I have a problem with a SPEAR 320 SOC board with kernel 2.6.27,using the
</I>&gt;<i> spr_can driver and only sysfs for config:
</I>&gt;<i> The board uses CAN0 and has only one other device on the bus.
</I>&gt;<i> I can transmit and receive fine for about 20 minutes, transmitting at 75 hz.
</I>&gt;<i> at this point the tx quits and returns with  No buffer space available.
</I>&gt;<i> candump shows that the tx has stopped transmitting completely but the rx
</I>&gt;<i> works fine. I am using different tx and rx sockets ,dont think that should
</I>&gt;<i> matter. Candump shows the received messages getting through fine, but
</I>&gt;<i> nothing for tx. Obviously the bus remains up sysfs status does not show any
</I>&gt;<i> problems. Also if I bring Can0 down and back up again, it flushes the
</I>&gt;<i> buffers and everything works ok for another several minutes. I have tried
</I>&gt;<i> increasing tx queue len and it does not help at all. Any ideas?  problems
</I>&gt;<i> with the driver? This sounds much like problems others have reported with
</I>&gt;<i> other drivers.
</I>
Does your application handle ENOBUFS on send/write? If your system is
busy with other task it may happen the the TX queue gets full. But as
the data rate is not really high and you tried to increase txqueuelen
already, I suspect a driver problem. Unfortunately, we do not maintain
or even know that driver. There is mainline support for that board using
the C_CAN driver. Any chance to switch to a recent kernel version?

Wolfgang.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/socketcan-users/attachments/20110601/3cd299a1/attachment.html">https://lists.berlios.de/pipermail/socketcan-users/attachments/20110601/3cd299a1/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001909.html">[Socketcan-users] SPEAR320 SOC TX problem
</A></li>
	<LI>Next message: <A HREF="001911.html">[Socketcan-users] Advantech PCI-1680U card
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1910">[ date ]</a>
              <a href="thread.html#1910">[ thread ]</a>
              <a href="subject.html#1910">[ subject ]</a>
              <a href="author.html#1910">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
