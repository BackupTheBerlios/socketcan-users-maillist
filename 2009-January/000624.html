<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20%5BXenomai-help%5D%20rtcanconfig%20rtcansend%20rtcanrecv&In-Reply-To=%3C496CAD93.9010206%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000623.html">
   <LINK REL="Next"  HREF="000625.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20%5BXenomai-help%5D%20rtcanconfig%20rtcansend%20rtcanrecv&In-Reply-To=%3C496CAD93.9010206%40grandegger.com%3E"
       TITLE="[Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv">wg at grandegger.com
       </A><BR>
    <I>Tue Jan 13 16:04:51 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000623.html">[Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv
</A></li>
        <LI>Next message: <A HREF="000625.html">[Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#624">[ date ]</a>
              <a href="thread.html#624">[ thread ]</a>
              <a href="subject.html#624">[ subject ]</a>
              <a href="author.html#624">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Charlton, John wrote:
&gt;<i> Wolfgang,
</I>&gt;<i> 
</I>&gt;<i> You are right.  I am just learning the sja1000 registers and modes and I was looking at the 'BasicCAN' register configuration and the sja1000 can driver is using the 'PeliCAN' mode.  So it does look like everything is configured correctly and it also looks like the data are tranferred from rtcan1 to rtcan0 registers except that the interrupts do not occur to notify the socket that the data is sent and received.  There does not appear to be any error messages but only debug messages in the dmesg output below (all of those Wrote/Read messages are generated by the rtcan_tscan1.c printk which I am removing to reduce the spew):
</I>
OK.

&gt;<i> - What do your read at offset 0x6 (JMP)?
</I>&gt;<i> For idx 0: 0x30, 1: 0x22
</I>
Looks good for the IRQ selection, but I can't tell what the bit 0x02 is
good for.

&gt;<i> - What does /proc/interrupts return?
</I>&gt;<i> cat /proc/interrupts
</I>&gt;<i>            CPU0       
</I>&gt;<i>   0:      12314    XT-PIC-XT        timer
</I>&gt;<i>   1:        146    XT-PIC-XT        i8042
</I>&gt;<i>   2:          0    XT-PIC-XT        cascade
</I>&gt;<i>   6:          0    XT-PIC-XT        uhci_hcd:usb1, uhci_hcd:usb2
</I>&gt;<i>  12:         13    XT-PIC-XT        eth0
</I>&gt;<i>  14:          0    XT-PIC-XT        ide0
</I>&gt;<i>  15:       2151    XT-PIC-XT        ide1
</I>&gt;<i> NMI:          0   Non-maskable interrupts
</I>&gt;<i> TRM:          0   Thermal event interrupts
</I>&gt;<i> ERR:          0
</I>
I just wanted to check if IRQ 3 and 5 is already used by Linux. You also
can set the Xenomai IRQ flags in your driver to

  chip-&gt;irq_flags = 0;

because IRQ sharing is not required.

Maybe there are x86-related problems with the IRQs. I'm not really an
expert, but sometimes there is trouble due to improper BIOS settings,
interrupt routing, etc.

Wolfgang.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000623.html">[Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv
</A></li>
	<LI>Next message: <A HREF="000625.html">[Socketcan-users] [Xenomai-help] rtcanconfig rtcansend rtcanrecv
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#624">[ date ]</a>
              <a href="thread.html#624">[ thread ]</a>
              <a href="subject.html#624">[ subject ]</a>
              <a href="author.html#624">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
