<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] CAN with switchable power
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2009-April/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20CAN%20with%20switchable%20power&In-Reply-To=%3C49E71486.7000602%40mlbassoc.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000784.html">
   <LINK REL="Next"  HREF="000793.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] CAN with switchable power</H1>
    <B>Gary Thomas</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20CAN%20with%20switchable%20power&In-Reply-To=%3C49E71486.7000602%40mlbassoc.com%3E"
       TITLE="[Socketcan-users] CAN with switchable power">gary at mlbassoc.com
       </A><BR>
    <I>Thu Apr 16 13:20:38 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000784.html">[Socketcan-users] CAN with switchable power
</A></li>
        <LI>Next message: <A HREF="000793.html">[Socketcan-users] CAN with switchable power
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#789">[ date ]</a>
              <a href="thread.html#789">[ thread ]</a>
              <a href="subject.html#789">[ subject ]</a>
              <a href="author.html#789">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Oliver Hartkopp wrote:
&gt;<i> Gary Thomas wrote:
</I>&gt;&gt;<i> Oliver Hartkopp wrote:
</I>&gt;&gt;&gt;<i> Gary Thomas wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> There is no error from the transceiver
</I>&gt;&gt;&gt;<i> There is an error pin on your transceiver. You should connect some logic
</I>&gt;&gt;&gt;<i> testing equipment to this pin (e.g. some kind of multi-meter).
</I>&gt;&gt;<i> You misunderstood - I _can_ monitor this pin and it is not asserted
</I>&gt;&gt;<i> when these problems occur.
</I>&gt;<i> 
</I>&gt;<i> Ok.
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> For this reason the other nodes (not your host) should generate CAN traffic on
</I>&gt;&gt;&gt;<i> their own ... and then your transceiver will find back to normal operation.
</I>&gt;&gt;<i> The CAN devices do this - they are normally in idle (CANOpen) mode and
</I>&gt;&gt;<i> send out a 1-byte packet every second or so.  The problem is that if
</I>&gt;&gt;<i> they are powered off when the CAN interface comes up, then powered on,
</I>&gt;&gt;<i> they don't seem to send this packet properly.  From what I'm told, they
</I>&gt;&gt;<i> appear to go into &quot;babble&quot; mode (probably because of no ACK)
</I>&gt;<i> 
</I>&gt;<i> A missing ACK can also be produced with a slightly different bitrate ...
</I>&gt;<i>
</I>
Any idea how to shake things up so that the CAN devices recover, once
they get into this state?

&gt;&gt;<i> As I said, we got the Peak-PCI card to do the same thing (I was testing
</I>&gt;&gt;<i> to see if they problem was with the FPGA core), so this condition seems
</I>&gt;&gt;<i> to be endemic with either the SJA1000 or the driver.
</I>&gt;<i> 
</I>&gt;<i> Do you use the the TJA1054 in a mix with High Speed transceivers like the
</I>&gt;<i> 82C251 or TJA1041?
</I>&gt;<i> 
</I>
We use only the TJA1054

&gt;<i> AFAIK the PEAK PCI adapter uses the 82C251 by default. Or do you use the
</I>&gt;<i> mentioned PEAK TJA1054 adaptor in your setup?
</I>
The embedded target is separate - FPGA + TJA1054 only.
I mentioned the Peak-PCI card only as a test to see if it suffered from
the same problems when using these CAN devices.

Where do I point the finger?  I'm supposed to be able to boot the system
with everything off, then bring it up only on command.  However, if the
CAN bus is started (probed only!) before the devices have power (a totally
separate control path), then the whole thing seems to get hosed :-(

Thanks for any ideas or thoughts


-- 
------------------------------------------------------------
Gary Thomas                 |  Consulting for the
MLB Associates              |    Embedded world
------------------------------------------------------------

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000784.html">[Socketcan-users] CAN with switchable power
</A></li>
	<LI>Next message: <A HREF="000793.html">[Socketcan-users] CAN with switchable power
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#789">[ date ]</a>
              <a href="thread.html#789">[ thread ]</a>
              <a href="subject.html#789">[ subject ]</a>
              <a href="author.html#789">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
