<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] HW Clock
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-users/2008-May/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20HW%20Clock&In-Reply-To=%3C48230E0C.5010109%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000333.html">
   <LINK REL="Next"  HREF="000340.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] HW Clock</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-users%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20HW%20Clock&In-Reply-To=%3C48230E0C.5010109%40grandegger.com%3E"
       TITLE="[Socketcan-users] HW Clock">wg at grandegger.com
       </A><BR>
    <I>Thu May  8 16:28:28 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000333.html">[Socketcan-users] General Dentists Contact List in America
</A></li>
        <LI>Next message: <A HREF="000340.html">[Socketcan-users] HW Clock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#339">[ date ]</a>
              <a href="thread.html#339">[ thread ]</a>
              <a href="subject.html#339">[ subject ]</a>
              <a href="author.html#339">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Breno,

please don't drop the CC to the mailing list.

<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-users">breno at das.ufsc.br</A> wrote:
&gt;&gt;<i> Oliver Hartkopp wrote:
</I>&gt;&gt;&gt;<i> Wolfgang Grandegger schrieb:
</I>&gt;&gt;&gt;&gt;<i> Breno wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Wolfgang Grandegger wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Hi Breno,
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-users">breno at das.ufsc.br</A> wrote:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Hi Wolfgang, I found  a message that seems somehow strange to me
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> while the
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> kernel is being loaded on my lite5200 board. It said at the end
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> that the
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> HW clock can't be read. Does it have any relevance? Could implicate
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> on
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> unexpected behavior for RT process?
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> I think it has nothing to do with Socket-CAN. Just disable
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Socket-CAN in
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> your kernel to check. And please be more precise next time by
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> providing
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>   more information, e.g. log output.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> What do you mean with RT process? In case you are using Xenomai or
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> RT-Soccket-CAN, you are off-topic here. Please send such questions to
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> the Xenomai-help mailing list.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Wolfgang.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi Wolfgang, I'm trying to send can packages from CAN0 interface and
</I>&gt;&gt;&gt;&gt;&gt;<i> receive them from CAN1 interface. I started two separated processes,
</I>&gt;&gt;&gt;&gt;&gt;<i> one
</I>&gt;&gt;&gt;&gt;&gt;<i> sending and another one receiving.  Unfortunately my read or recvfrom
</I>&gt;&gt;&gt;&gt;&gt;<i> commands is blocked, I mean it seems that no bytes are read.
</I>&gt;&gt;&gt;&gt;&gt;<i> The ifconfig command didn't return any packages sent or received at
</I>&gt;&gt;&gt;&gt;&gt;<i> any
</I>&gt;&gt;&gt;&gt;&gt;<i> interface.
</I>&gt;&gt;&gt;&gt;&gt;<i> But the /proc/net/can/stats show messages like:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Hm, &quot;/proc/net/can/stats&quot; does not exist.
</I>&gt;&gt;<i> Ah, it exists, of course. Sorry for the noise.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi Wolfgang and Breno,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> i'm a bit confused about the /proc/net/can/stats . Especially because
</I>&gt;&gt;&gt;<i> these exorbitant values ...
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>       100 % current match ratio (CRXMR)
</I>&gt;&gt;&gt;&gt;&gt;<i>     29635 frames/s current tx rate (CTXR)
</I>&gt;&gt;&gt;&gt;&gt;<i>     29635 frames/s current rx rate (CRXR)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ... do not look very sane.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The only way to produce these high frame rates is to work with the
</I>&gt;&gt;&gt;<i> virtual CAN driver (vcan).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> A 'real' CAN bus can handle up to 2.000 - 3.000 frames.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Could it be that you mixed the SocketCAN sources with the RT-SocketCAN
</I>&gt;&gt;&gt;<i> sources?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I don't know if RT-SocketCAN also supports the procfs  statistics ?!?
</I>&gt;&gt;<i> Yes, but under /proc/rtnet. Breno, could you please tell use what
</I>&gt;&gt;<i> Software you are using e.g.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - Kernel source and version
</I>&gt;&gt;<i> - Socket-CAN source and version
</I>&gt;&gt;<i> - RT-Socket-CAN?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Wolfgang.
</I>&gt;&gt;<i>
</I>&gt;<i> Hi all, I got a DENX Linux 2.6 Kernel Tree from DENX project. The last
</I>&gt;<i> commit I have is:
</I>&gt;<i> 
</I>&gt;<i> commit 76e8fbcc9e3e928a6898a93e6077264f5cb8f432
</I>&gt;<i>   Author: Wolfgang Grandegger &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-users">wolf at pollux.denx.de</A>&gt;
</I>&gt;<i>   Date:   Thu Mar 27 17:41:09 2008 +0100
</I>&gt;<i> 
</I>&gt;<i>   Socket-CAN: merge with SVN trunk revision 690
</I>
OK.

&gt;<i> I didn&#180;t run the dump code yet. I&#180;ll try it! But it is odd there is
</I>
First use programs known to work, please, e.g. cansend and candump.

&gt;<i> nothing returned on ifconfig command, isn&#180;t it? Btw, on my kernel option I
</I>&gt;<i> have Suppot for Freescale MSCAN chips, is it the driver, I mean, once
</I>&gt;<i> enable this option I got the driver instaled or what?
</I>
Do you use vcan?

Have you already seen CAN messages on the CAN bus from your MSCAN, e.g.
with an external CAN bus analyzer.

Could you please build the canconfig utility from

<A HREF="https://lists.berlios.de/pipermail/socketcan-core/2007-July/000549.html">https://lists.berlios.de/pipermail/socketcan-core/2007-July/000549.html</A>

and run it on your board:

  # canconfig -b 5000000 can0 up
  # canconfig -b 5000000 can1 up

Does it help? I remember a problem with initial bit-rate setting for MSCAN.

Wolfgang.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000333.html">[Socketcan-users] General Dentists Contact List in America
</A></li>
	<LI>Next message: <A HREF="000340.html">[Socketcan-users] HW Clock
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#339">[ date ]</a>
              <a href="thread.html#339">[ thread ]</a>
              <a href="subject.html#339">[ subject ]</a>
              <a href="author.html#339">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-users">More information about the Socketcan-users
mailing list</a><br>
</body></html>
